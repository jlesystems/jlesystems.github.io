import{r as t,aI as ue,aJ as V,aK as fe,aF as de,b as me,n as ge,aL as Se,c as ye,j as d,k as ee,a5 as _e,a as ve,aC as Ee,S as X,aM as Y,aN as Ne}from"./index-DCVMByM4.js";const Ae="100%",Re="1.5",he="cover",U={defaultWidth:Ae,defaultAspectRatio:Re,defaultObjectFit:he};function pe(e,a,s){const[i,r]=t.useState({src:void 0,loading:!!e&&!a});return t.useEffect(()=>{if(!e||!ue()){r({src:void 0,loading:!1});return}if(a){const u=V(e);r({src:u,loading:!1});return}const l=fe(e);if(l){r({src:l,loading:!1});return}let o=!1;return r({src:void 0,loading:!0}),de(e,s).then(u=>{o||r({src:u,loading:!1})}).catch(()=>{if(!o){const u=V(e);r({src:u,loading:!1})}}),()=>{o=!0}},[e,a,s]),i}const Fe=ge.loaderTimeout;function be(){const{withTimeout:e}=me(),[a,s]=t.useState(void 0),[i,r]=t.useState(!1),[l,o]=t.useState(!1),u=t.useCallback(S=>{e(()=>{s(S)},S?0:Fe)},[e]);t.useEffect(()=>{a===!1?r(!0):a===!0&&o(!0)},[a]);const v=t.useCallback(()=>{s(void 0),r(!1),o(!1)},[]);return{ready:a,shouldAnimate:i,fadeIn:l,setReady:u,reset:v}}const ke=t.forwardRef(({variant:e="primary",isOpen:a,onCancel:s,focusOnOpen:i=!0,maxWidth:r,maxHeight:l,width:o,height:u,sideGap:v,padding:S,border:E,borderRadius:h,backdropColor:p,backdropBlur:A,portalTarget:k,className:T,style:F,children:x,...I},b)=>{Se(a!==void 0&&!!a?["no-scroll"]:[]);const f=t.useRef(null);t.useImperativeHandle(b,()=>f.current,[]);const[y,j]=t.useState(!1),N=t.useMemo(()=>({...{...r!=null?{"--dialog-max-width":r}:{},...l!=null?{"--dialog-max-height":l}:{},...o!=null?{"--dialog-width":o}:{},...u!=null?{"--dialog-height":u}:{},...v!=null?{"--dialog-side-gap":v}:{},...S!=null?{"--dialog-padding":S}:{},...E!=null?{"--dialog-border":E}:{},...h!=null?{"--dialog-border-radius":h}:{},...p!=null?{"--dialog-backdrop-color":p}:{},...A!=null?{"--dialog-backdrop-blur":A}:{}},...F??{}}),[r,l,o,u,v,S,E,h,p,A,F]);t.useEffect(()=>{j(!0)},[]),t.useEffect(()=>{ye(()=>{const c=f.current;if(c&&a!==void 0)try{a?(c.open||c.showModal(),i&&c.focus()):c.open&&c.close()}catch{}})},[a,i]);const m=c=>{if(c.preventDefault(),s){s();return}a===void 0&&f.current?.close()},g=d.jsx("dialog",{ref:f,className:ee("dialog",T),style:N,onCancel:m,variant:e,...I,children:x});if(!y)return null;const _=k??(typeof document<"u"?document.body:null);return _?_e.createPortal(g,_):null}),Te=(e,a)=>{const s=a-1,i=a-2;return a<=1?"100%":e===s?"70%":e===i?"85%":"100%"},je=({rows:e=0})=>e<=0?d.jsx("div",{className:"skeleton skeleton__block","aria-busy":"true"}):d.jsx("div",{className:"skeleton skeleton__rows","aria-busy":"true",children:Array.from({length:e}).map((a,s)=>d.jsx("div",{className:"skeleton__row",style:{width:Te(s,e)}},s))}),we=U.defaultWidth,xe=U.defaultAspectRatio,Z=U.defaultObjectFit,z=e=>e!=null&&e!=="",L=e=>e==="auto"?void 0:e,Ie=e=>e==="auto"||e===""?void 0:e,Ce=e=>{if(e==null||e===""||e==="auto")return;if(typeof e=="number")return Number.isFinite(e)&&e>0?e:void 0;const a=String(e).trim();if(!a)return;if(a.includes("/")){const[i,r]=a.split("/"),l=Number.parseFloat(i.trim()),o=Number.parseFloat(r.trim());return Number.isFinite(l)&&Number.isFinite(o)&&l>0&&o>0?l/o:void 0}const s=Number.parseFloat(a);if(Number.isFinite(s)&&s>0)return s};function De({src:e,disableBlob:a=!1,disableLazyLoading:s=!1,objectFit:i,aspectRatio:r,clickOpenMode:l="none",style:o,className:u,onLoad:v,onError:S,fetchPriority:E="auto",loading:h="eager",decoding:p="async",width:A,height:k,onClick:T,alt:F,...x},I){const{screenType:b}=ve(),M=Ee(),{src:f}=pe(e,a,E),{ready:y,setReady:j,reset:N}=be(),[m,g]=t.useState(!1),[_,c]=t.useState("none"),{boxStyle:te,imgStyle:se,useSizer:ae}=t.useMemo(()=>{const n=L(A),H=L(k),J=Ie(r),q=z(n),D=z(H),K=z(J),$=!K&&!D,le=q&&D?void 0:K?J:$?xe:void 0,ce=q?n:we,G=D?H:void 0,ie=$&&i==null?Z:i??Z,P=Ce(le),Q=G==null&&P!=null;return{boxStyle:{width:ce,height:G,...Q?{"--lazy-image-ar":P}:{}},imgStyle:{objectFit:ie},useSizer:Q}},[r,i,A,k]),C=t.useMemo(()=>!(b===X.Mobile||b===X.Error),[b]),w=t.useCallback(n=>{j(n)},[j]);t.useEffect(()=>()=>{g(!1)},[]),t.useEffect(()=>{!f&&m&&g(!1)},[f,m]),t.useEffect(()=>{y===!1&&!s&&m&&g(!1)},[y,s,m]),t.useEffect(()=>{s||(e?(N(),c("none"),w(!1)):(N(),c("none")))},[e,N,w,s]),t.useEffect(()=>{if(!s){if(y===!1)c("fade");else if(y===!0&&_==="fade"){const n=requestAnimationFrame(()=>{c("fade-in")});return()=>{cancelAnimationFrame(n)}}}},[y,_,s]),t.useEffect(()=>{s&&(N(),c("none"))},[s,N]),t.useEffect(()=>{m&&!C&&g(!1)},[C,m]),t.useEffect(()=>{u&&Y()},[u]),t.useEffect(()=>{o&&Y()},[o]);const R=y===!1&&!s,W=l==="tab"&&!!f&&!R,O=l==="dialog"&&!!f&&!R&&C,B=(!!T||W||O)&&!R,ne=s?{}:{"lazy-image__fade":_==="fade"||_==="fade-in","lazy-image__fade-in":_==="fade-in"},re=R?{}:{"lazy-image__clickable":B},oe=ae?{"lazy-image__sizer":!0}:{};return d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:ee("lazy-image",ne,re,oe),style:te,children:[R&&d.jsx(Ne,{children:d.jsx("div",{className:"lazy-image__skeleton",children:d.jsx(je,{})})}),f&&d.jsx("img",{...x,ref:I,src:f,alt:F,className:"lazy-image__image",draggable:!1,style:se,onClick:n=>{if(R){n.preventDefault();return}if(T?.(n),!n.defaultPrevented){if(W){M(f);return}O&&g(!0)}},onLoad:n=>{w(!0),v?.(n)},onError:n=>{w(!0),S?.(n)},loading:h,decoding:p,...E?{fetchpriority:E}:{}})]}),B&&d.jsx(ke,{isOpen:m,className:"lazy-image__dialog",onCancel:()=>g(!1),onClick:n=>{n.target===n.currentTarget&&g(!1)},children:d.jsx("img",{src:f,alt:F,className:"lazy-image__dialog-image",draggable:!1,onClick:n=>{n.stopPropagation()}})})]})}const Ue=t.forwardRef(De);export{Ue as L,je as S,be as u};
